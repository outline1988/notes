## 干扰机与干扰策略

### 捷变频雷达的信号模型

频率捷变信号本质上来说就是载频在一定带宽内不断变换的信号，根据其变换载频时间间隔的特点，可将其分为脉内捷变频信号、脉间捷变频信号和脉组捷变频信号。

**一般的雷达信号**
雷达信号一般为窄带信号，通常将雷达的信号写成复信号形式
$$
s_{\text{t}}(t) = u(t) \exp(\mathrm{j}2\pi f_{\text c} t)
$$
注意，此时我们将雷达信号$s_{\text t}(t)$视为是一个在正负时间轴内无限延伸的连续复信号，因此这个统一雷达信号可以表示任意类型的雷达信号。我们举例来说最为常见的脉冲信号，此时的复包络就是一个周期门函数信号，可以表示为
$$
\begin{aligned}
u(t) &= g_{\tau}(t) \ast \delta_{T_r}(t) \\
&= \text{rect}({\frac{t}{\tau}}) \ast \delta_{T_r}(t)
\end{aligned}
$$
上式第一行中，我们取了最为熟悉的门函数表达式$g_{\tau}(t)$，该函数就是横跨正负半轴，且总门宽为$\tau$的们函数，在课程信号与系统中大量出现，所以最为熟悉；第二行中的$\text{rect}(t)$更常见于雷达领域，其本质就是门宽为1的门函数，即$\text{rect}(t) = g_{\tau}(t) \big|_{\tau = 1}$；$\ast$代表卷积，与$\delta_{T_s}$表示的周期冲击串共同使得门函数进行周期延拓。

虽然实际的发射信号都是以$t=0$开始，但是为了数学的表达方便，即让$f_{\text{c}}$为雷达信号的中心频率，常常使得复信号都是以负半轴$t = \frac{\tau}{2}$开始的。由于我们所研究的大部分为脉冲信号，所以为了研究方便，我们通常所指的雷达信号都只有一个脉冲周期长度，并且在函数图像上，以门函数作为偶函数来表达。

**脉间捷变频信号**
脉间频率捷变雷达信号中的第$m$个脉冲为
$$
s(t)=u(t)\exp(\mathrm{j} 2\pi f_m t)
$$
其中，$f_m$为捷变频信号第$m$个脉冲的载频，具体为
$$
f_m = f_c + a(m)\Delta f, ~~m = 1, 2, \cdots, M
$$

其中，$M$为脉冲积累数；$a(m)$为某个整数，称之为第$m$个脉冲的频率调制码字，取值范围$0 \leq a(m) \leq N - 1$，$N$为总的跳频数。

频率捷变雷达一般采样线性调频（linear frequency modulated，LFM），复包络为
$$
u(t)=\text{rect}\left(\frac{t}{T_e}\right)\exp(\mathrm{j}\pi\gamma t^2)
$$
其中，$T_e$为脉冲持续时间。

说到底，脉间捷变频信号的数学表示相当于将普通的雷达信号中的载频改变，都是单脉冲表示。

**脉内捷变频信号**
脉间频率捷变雷达信号中同一个脉冲内第$k$个子脉冲为
$$
s_{\text{sub}}(t, k)=u(t)\exp(\mathrm{j} 2\pi f_k t)
$$
其中，$f_k$为捷变频信号第$k$个脉冲的载频，具体为
$$
f_k = f_c + a(k)\Delta f, ~~k = 1, 2, \cdots, K
$$

其中，$K$表示每个发射脉冲信号中子脉冲的个数；$a(k)$为某个整数，称之为第$k$个子脉冲的频率调制码字，取值范围$1 \leq a(k) \leq N$，$N$为总的跳频数。

频率捷变雷达一般采样线性调频（linear frequency modulated，LFM），复包络为
$$
u(t)=\text{rect}\left(\frac{t}{T_\text{sub}}\right)\exp(\mathrm{j}\pi\gamma t^2)
$$
其中，$T_{\text{sub}} = T_{e} / K$为子脉冲持续时间，$T_e$为脉冲持续时间；$\gamma = B_{\text{sub}} / T_{\text{sub}}$​为每个子脉冲的调频斜率。

将每个子脉冲组合拼接，则可得到一个脉冲的信号
$$
s(t) = \sum_{k = 1}^{K}s_{\text{sub}}(t - \tau_k, k)
$$
其中，$\tau_k$为每个子脉冲对应的时延，相邻子脉冲之间时延差为一个子脉冲持续时间$\Delta \tau = T_{\text{sub}}$​。下图为脉内捷变频信号的时频域图

![image-20240423210052287](C:\Users\outline\AppData\Roaming\Typora\typora-user-images\image-20240423210052287.png)

### 雷达抗干扰的手段

面对干扰机的不同的干扰策略，雷达可主动采取脉间-脉内跳频的方式进行抗干扰。故我们假设雷达发射的信号都为脉内-脉间调频信号，agent与环境互动的频率为一个脉冲重复频率，抽象后只需要在脉冲持续时间内的信号即可，其内包含了多个子脉冲的不同频点，故可用一维np向量表示。例如`s = np.array([1, 1, 3, 2, 1, 2, 2, 0, 1, 2])`表示一个脉冲的发射信号，其包含10个子脉冲，每个子脉冲都具有不同的频点，代表着脉内调频。

*是一个脉冲持续时间，还是一个cpi时间？*

**脉内跳频**
将雷达信号的一个脉冲信号的脉冲持续时间$T_e$内分成$N$个子脉冲，每个子脉冲持续时间
$$
T_{sub} = \frac{T_e}{N}
$$
通过不同的脉内跳频方式（$N$个不同频点的组合），可达到针对干扰机某一特定干扰不同的抗干扰能力。强化学习的目的就是找出最好的频点组合，以获得最好的抗干扰能力。

**脉间跳频**
除了在同一子脉冲中搭配不同的频点来达到抗干扰的效果，也可以在不同的脉冲之间搭配不同的脉内频点组合方式来达到抗干扰的效果。

为了将强化学习运用到抗干扰策略（脉内-脉间不同频点方式如何组合），我们需要将雷达与干扰机互动的场景抽象成强化学习的元素。最重要的便是环境、状态和动作。

### 总体环境
环境需要接收agent所做出的动作，返回给agent一个奖励和后继状态。若将环境视为一个系统，则该系统的输入为agent做出的动作，输出为奖励和agent的后继状态。在雷达与干扰机互动的场景下，动作空间可选择为：同一脉冲内，不同子脉冲不同频点的搭配情况；状态空间可选择为：上个脉冲雷达的发射信号，即同一脉冲中频点的选择。如此设置下，状态空间和动作空间几乎一致，大小相同。

*该状态和动作的选择只是一个例子，光由自己上次怎么发射脉冲信号来决定下次怎样发射脉冲信号，效果怎样还需要结合干扰机具体的干扰策略进行分析。*

**环境的主体：干扰机**
干扰机通过采集雷达的发射信号，发出干扰信号来达到干扰雷达的功能。我们将干扰机抽象为环境的最重要的一部分，其接受雷达发射的信号（agent做出的动作，即雷达发射波形中，同一脉冲中不同频点的组合），返回干扰信号（同样是同一脉冲内不同频点的组合）。

**环境的剩余部分**
干扰机虽然接受的是雷达的发射信号（agent所作的动作），但是返回的是干扰信号。完整的环境输出应该为下一个状态和奖励，所以还需要某个模块，其能将干扰信号转换为后继状态和奖励，由此与干扰机共同组成一个环境系统。

### 干扰机环境

干扰机所作出的动作本质上就是**侦察接收**和**干扰转发**。

正如前面所说，干扰机环境接受雷达一个脉冲的信号，返回干扰信号一个脉冲的干扰信号。为了方便编程，发射信号被抽象为了一个一维np向量，其每一个元素代表一个子脉冲所用的频点（这里的频点抽象为了一个标量，范围为0到频点数-1），所有子脉冲的频点共同构成了雷达发射波形的一个脉冲持续时间。

同样，干扰机输出的干扰信号被抽象为了一个二维np矩阵，不同行代表不同的子脉冲，不同列代表不同的频点。对于特定的某一行中，不同的元素的值代表不同频点能量所分配的情况，每行都满足能量归一化条件（能量最高为1，对同一行求和会得到1）。

一下情况将根据python中的干扰机环境程序来叙述

**干扰机策略：阻塞干扰**

- 选择一个中心频点，按照一定的带宽，对符合的频点进行干扰。

- 也可以对所有频点都进行干扰。

**干扰机策略：储频转发**
由于python中还未进行信号级别的仿真，所有从本质上，储频转发干扰所达到的效果和阻塞干扰的效果是一样的。我们所做的不是从被干扰到的信号中提取想要的信号，而是避免信号被干扰到（主动干扰）。从整体上，干扰机的策略可以分为三步：接收信号、统计分析和发送信号。通过接收最小单位是否为子脉冲，干扰策略分为脉内干扰和脉间干扰。

对于脉内干扰，干扰机一次接收$n$个子脉冲，随后发射$m$个子脉冲，干扰机的干扰信号起止与发射的一个脉冲相同。

可以对接收到的$n$个子脉冲，单频点发送（一个脉冲只包含一个频点）：

- 直接转发一次；
- 直接转发若干次；
- 循环转发（采集到的所有子脉冲频点一起转发）；
- 统计找到最新的频点，单频点发送；
- 统计找到最多的频点，单频点发送；
- 随机从采样的频点中选择一个频点发送；
- 随机从采样的频点中选择多个频点，分到不同的发射子脉冲单频点发送。

也可以对收到的$n$个子脉冲，多频点发送（同一脉冲包含多个频点）：

- 统计固定数目最新的频点，按照极大似然准则功率分配到一个子脉冲发送；
- 对采样的频点进行数目的排序，统计固定数目最常出现的多个频点按照极大似然准则功率分配到一个子脉冲发送；
- 随机从采样的频点中选择多个频点，按极大似然准则功率分配的一个脉冲发送，不同脉冲频点不重新抽取；
- 随机从采样的频点中选择多个频点，按极大似然准则功率分配的一个脉冲发送，不同脉冲重新抽取；
- 统计所有采集到的频点，干扰全部频点，每个子脉冲都相同。

对于脉间干扰，干扰机环境还接受了代表时间变化的慢时间参数，由此进行脉冲间的信号干扰：

- 直接转发一次；
- 直接转发多次；
- 循环转发（采集到的所有脉冲一起转发）；
- 采集到最新的一个频点（子脉冲的频点），整个脉冲一个频点发送；
- 采集到最多的一个频点（子脉冲的频点），整个脉冲一个频点发送；
- 从采集到的频点中随机选择一个频点，脉内频点相同，脉间相同；
- 从采集到的频点中随机选择一个频点，脉内频点相同，脉间不同；
- 从采集到的频点中随机选择一个频点，脉内频点不同，脉间相同；
- 从采集到的频点中随机选择一个频点，脉内频点不同，脉间不同。

脉间干扰也有多频干扰

- 统计固定数目最新的频点，按照极大似然准则功率分配到一个脉冲的脉冲（所有子脉冲）发送；
- 统计固定数目最多的频点，按照极大似然准则功率分配到一个脉冲的脉冲（所有子脉冲）发送；
- 从采集到的频点中随机选择固定数目频点，脉内频点相同，脉间相同；
- 从采集到的频点中随机选择固定数目频点，脉内频点相同，脉间不同；
- 从采集到的频点中随机选择固定数目频点，脉内频点不同，脉间相同；
- 从采集到的频点中随机选择固定数目频点，脉内频点不同，脉间不同；
- 统计所有采集到的频点，干扰全部频点，一个脉冲内的所有子脉冲相同。

## policy based方法在抗干扰问题上的状态空间和动作空间设置

### 总体设置概述

- 假设发射脉冲有$m$个子脉冲，$n$个频点。
- 状态空间：前$k$个子脉冲的发射频点组合，和对应干扰频点情况（这里假设$k$为1）；
- 动作空间：即将要发射的子脉冲频点组合。

### 最直接的设置

**状态空间**
雷达发射脉冲可视为一个$m$长度的一维向量，该向量中的每一个元素都固定取值至$[0, n - 1]$的整数。

假设干扰机的功率固定，则干扰的情况可视为一个$m \times n$的矩阵，则每一行代表同一子脉冲中不同频点的功率分配情况；每一列代表同一个频点在不同子脉冲的功率分配情况。由于干扰机功率固定，所以必须要求：矩阵中的每个元素具有非负性；每行的行和为1。

**动作空间**
仍然是雷达发射脉冲的$m$长度一维向量。

### 离散动作空间的优化1（完成）

在动作空间较少的时候，通常使用离散优化的方法，即actor的输出为动作空间大小的向量，向量中每一个元素代表取该动作的概率。由于动作空间是离散的，故无论哪种动作空间的表征方式都是等价的，所以我们为动作空间中的每一个动作都进行一个编号，这种编号可以任意，但是为了方便，我们采用了进制转换的关系来对动作进行编码。举例来说，参数为4个子脉冲4个频点的某次发射脉冲为$[1, 0, 3, 2]$，则我们视这些数字为4位4进制数中的每一位数，由此我们能够将其转换为一个十进制数78，则该数就代表该脉冲的编码情况。

由于状态空间中仍然包括动作空间的设置，所以状态空间也这样进行离散化。*但是这里有一个疑点，状态空间实际上没有维度爆炸的问题，无非就是多增加状态空间的维度，所以感觉状态空间中的脉冲也进行十进制转换的意义不大。*

### 连续动作空间的优化1（完成）

由于雷达发射脉冲的频点组合数为$n^m$，该值随着子脉冲数和频点数的增长都是十分巨大的。如果仍旧使用离散的状态空间，那么actor的输出就是一个十分巨大的一维数组，这对于后续的计算资源和存储空间的要求是难以忍受的。我们借由可将雷达发射脉冲转换为一个十进制数的思路，将这个十进制数压缩至一定范围区间，比如说$[-1, 1]$。我们让actor的输出直接就是一个高斯分布，由于高斯分布只由两个参数$\mu$和$\sigma$控制，所以等价于让actor只有两个输出。actor输出的分布当前来说只有一维，pdf中每一个横坐标都代表着一个动作。我们对这个分布进行采样，就可以得到这个动作。

*这里的问题是，当动作空间十分巨大的时候，将所有动作压缩至同一范围，会使得相邻动作之间的数值差距感十分小，由此还原为十进制数的过程中，误差会十分巨大。是否可以让连续动作空间的维度不止只有一维？*

*动作空间连续化后，状态空间是否也要相应变动？*

### 连续动作空间的优化2

上述连续动作空间优化1是基于离散动作空间的优化1进行的，既然将一个十分巨大的动作空间压缩到同一维度会造成相邻动作之间数值差距过小，那么我们可以将动作空间优化至不止一个维度，比如说，每两个子脉冲压缩到一个维度。由此换取的代价就是actor的输出不再只是一个分布，而是多个分布，我们在这多个分布上取值，来得到最终的动作。

### 状态空间中干扰情况的优化1

状态空间中干扰矩阵往往是一个十分稀疏的矩阵，能否将其降维呢？首先将干扰的程度视为不同的等级（量化），比如量化等级为5，那么干扰矩阵中相应元素上的取值就是$[0, 4]$的整数，由此仍然按照进制数之间的关系来进行转换，由此实现了干扰情况的降维。







